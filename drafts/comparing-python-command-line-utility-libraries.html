<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Comparing Python Command-Line Utility Libraries. - Kyle W. Purdon</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://kylepurdon.com/blog/drafts/comparing-python-command-line-utility-libraries.html">

        <meta name="author" content="Kyle W. Purdon" />
        <meta name="keywords" content="python,development" />
        <meta name="description" content="A comparison of Python command-line utility libraries (argparse, docopt, and click)." />

        <meta property="og:site_name" content="Kyle W. Purdon" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Comparing Python Command-Line Utility Libraries."/>
        <meta property="og:url" content="http://kylepurdon.com/blog/drafts/comparing-python-command-line-utility-libraries.html"/>
        <meta property="og:description" content="A comparison of Python command-line utility libraries (argparse, docopt, and click)."/>
        <meta property="article:published_time" content="2015-07-29" />
            <meta property="article:section" content="Software, Tools" />
            <meta property="article:tag" content="python" />
            <meta property="article:tag" content="development" />
            <meta property="article:author" content="Kyle W. Purdon" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://kylepurdon.com/blog/theme/css/bootstrap.cerulean.min.css" type="text/css"/>
    <link href="http://kylepurdon.com/blog/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://kylepurdon.com/blog/theme/css/pygments/friendly.css" rel="stylesheet">
    <link rel="stylesheet" href="http://kylepurdon.com/blog/theme/css/style.css" type="text/css"/>
        <link href="http://kylepurdon.com/blog/static/custom.css" rel="stylesheet">





</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://kylepurdon.com/blog/" class="navbar-brand">
            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="http://kylepurdon.com">Home</a></li>
                    <li><a href="http://kylepurdon.com/blog">Blog</a></li>
                    <li><a href="http://kylepurdon.com/about.html">About</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://kylepurdon.com/blog/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://kylepurdon.com/blog/drafts/comparing-python-command-line-utility-libraries.html"
                       rel="bookmark"
                       title="Permalink to Comparing Python Command-Line Utility Libraries.">
                        Comparing Python Command-Line Utility Libraries.
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-07-29T00:00:00-06:00"> Wed 29 July 2015</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="http://kylepurdon.com/blog/tag/python.html">python</a>
        /
	<a href="http://kylepurdon.com/blog/tag/development.html">development</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Some Introduction Here.</p>
<h1>Command Line Example</h1>
<p>The command line tool that we are creating will have the following interface:</p>
<p><code>python [file].py [command] [options] NAME</code></p>
<p><strong>Basic Usage</strong></p>
<div class="highlight"><pre><span class="nv">$ </span>python <span class="o">[</span>file<span class="o">]</span>.py hello Kyle
Hello, Kyle!

<span class="nv">$ </span>python <span class="o">[</span>file<span class="o">]</span>.py goodbye Kyle
Goodbye, Kyle!
</pre></div>


<p><strong>Usage w/ Options (Flags)</strong></p>
<div class="highlight"><pre><span class="nv">$ </span>python <span class="o">[</span>file<span class="o">]</span>.py hello --greeting<span class="o">=</span>Wazzup Kyle
Whazzup, Kyle!

<span class="nv">$ </span>python <span class="o">[</span>file<span class="o">]</span>.py goodbye --greeting<span class="o">=</span>Later Kyle
Later, Kyle!

<span class="nv">$ </span>python <span class="o">[</span>file<span class="o">]</span>.py hello --caps Kyle
HELLO, KYLE!

<span class="nv">$ </span>python <span class="o">[</span>file<span class="o">]</span>.py hello --greeting<span class="o">=</span>Wazzup --caps Kyle
WAZZUP, KYLE!
</pre></div>


<p>This simple command line tool breaks down into a few things the library we choose will need to implement:</p>
<ol>
<li>Commands (hello, goodbye)</li>
<li>Arguments (name)</li>
<li>Flags/Options (--greeting, --caps)</li>
</ol>
<p>In addition automated help messages are important, and to throw a wrench in lets say we also want a <code>-v/--version</code> option that will print the version number and quit. As you would expect argparse, docopt, and click implement all of these features (as any simple command line library would). This means that this comparison is mostly going to break down into a stylistic preference. I'll leave my personal preferences for the end!</p>
<p>I've been curious about using task-runner libraries like <a href="">fabric</a> and it's python3 replacement <a href="">invoke</a> to create simple command-line interfaces so at the end (after comparing argparse, docopt, and click) I will try and put the same interface together with invoke.</p>
<h1>Commands</h1>
<p>Let's begin by setting up the basic skeleton (no arguments or options) with each library.</p>
<h3>Argparse</h3>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">argparse</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">subparsers</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_subparsers</span><span class="p">()</span>

<span class="n">hello_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s">&#39;hello&#39;</span><span class="p">)</span>
<span class="n">goodbye_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s">&#39;goodbye&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</pre></div>


<p>With this we now have two commands (hello, goodbye) and a built-in help message. Notice that the help message changes when run as an option on the command hello.</p>
<div class="highlight"><pre><span class="nv">$ </span>python argparse/commands.py --help
usage: commands.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">{</span>hello,goodbye<span class="o">}</span> ...

positional arguments:
  <span class="o">{</span>hello,goodbye<span class="o">}</span>

optional arguments:
  -h, --help       show this <span class="nb">help </span>message and <span class="nb">exit</span>

<span class="nv">$ </span>python argparse/commands.py hello --help
usage: commands.py hello <span class="o">[</span>-h<span class="o">]</span>

optional arguments:
  -h, --help  show this <span class="nb">help </span>message and <span class="nb">exit</span>
</pre></div>


<h3>Docopt</h3>
<div class="highlight"><pre><span class="sd">&quot;&quot;&quot;Greeter.</span>

<span class="sd">Usage:</span>
<span class="sd">  commands.py hello</span>
<span class="sd">  commands.py goodbye</span>
<span class="sd">  commands.py -h | --help</span>

<span class="sd">Options:</span>
<span class="sd">  -h --help     Show this screen.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">arguments</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>
</pre></div>


<p>With this we now have two commands (hello, goodbye) and a built-in help message. Notice that the help message <strong>DOES NOT</strong> change when run as an option on the command hello. In addition we do not actually need to explicitly specify the <code>commands.py -h | --help</code> or the <em>Options</em> section to get a help command. However, if we do not specify them they will not show up in the output help message as options.</p>
<div class="highlight"><pre><span class="nv">$ </span>python docopt/commands.py --help
Greeter.

Usage:
  commands.py hello
  commands.py goodbye
  commands.py -h <span class="p">|</span> --help

Options:
  -h --help     Show this screen.

<span class="nv">$ </span>python docopt/commands.py hello --help
Greeter.

Usage:
  commands.py hello
  commands.py goodbye
  commands.py -h <span class="p">|</span> --help

Options:
  -h --help     Show this screen.
</pre></div>


<h3>Click</h3>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">click</span>


<span class="nd">@click.group</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">greet</span><span class="p">():</span>
    <span class="k">pass</span>


<span class="nd">@greet.command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="nd">@greet.command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">goodbye</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">greet</span><span class="p">()</span>
</pre></div>


<p>With this we now have two commands (hello, goodbye) and a built-in help message. Notice that the help message changes when run as an option on the command hello.</p>
<div class="highlight"><pre><span class="nv">$ </span>python click/commands.py --help
Usage: commands.py <span class="o">[</span>OPTIONS<span class="o">]</span> COMMAND <span class="o">[</span>ARGS<span class="o">]</span>...

Options:
  --help  Show this message and exit.

Commands:
  goodbye
  hello

<span class="nv">$ </span>python click/commands.py hello --help
Usage: commands.py hello <span class="o">[</span>OPTIONS<span class="o">]</span>

Options:
  --help  Show this message and exit.
</pre></div>


<p>Even at this point you can see that we have very different approaches to constructing a basic command line tool. Next let's add the <em>NAME</em> argument, and the logic to print the result to each tool.</p>
<h1>Arguments</h1>
<p>In this section I will be adding new logic to the same code shown in the previous section. I'll add comments to new lines stating there purpose. Arguments (a.k.a positional arguments) are required inputs to a command line tool. In this case we are adding a required "name" argument so that the tool can greet a specific person.</p>
<h3>Argparse</h3>
<p>To add an argument to a subcommand we use the <code>add_argument</code> method. And in order to execute the correct logic when a command is called we use the <code>set_defaults</code> method to set a default function. Finally we execute the default function by calling <code>args.func(args)</code> after we parse the arguments at runtime.</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">argparse</span>


<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Hello, {0}!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">goodbye</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Goodbye, {0}!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">subparsers</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_subparsers</span><span class="p">()</span>

<span class="n">hello_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s">&#39;hello&#39;</span><span class="p">)</span>
<span class="n">hello_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>  <span class="c"># add the name argument</span>
<span class="n">hello_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">hello</span><span class="p">)</span>  <span class="c"># set the default function to hello</span>

<span class="n">goodbye_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s">&#39;goodbye&#39;</span><span class="p">)</span>
<span class="n">goodbye_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>
<span class="n">goodbye_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">goodbye</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">args</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>  <span class="c"># call the default function</span>
</pre></div>


<div class="highlight"><pre><span class="nv">$ </span>python argparse/arguments.py hello Kyle
Hello, Kyle!

<span class="nv">$ </span>python argparse/arguments.py hello --help
usage: arguments.py hello <span class="o">[</span>-h<span class="o">]</span> name

positional arguments:
  name

optional arguments:
  -h, --help  show this <span class="nb">help </span>message and <span class="nb">exit</span>
</pre></div>


<h3>Docopt</h3>
<p>In order to add an option we simply add a <code>&lt;name&gt;</code> to the docstring. The <code>&lt;&gt;</code> are used to designate a positional argument. In order to execute the correct logic we must check if the command (treated as an argument) is True at runtime <code>if arguments['hello']:</code>, then dispatching to the correct functions.</p>
<div class="highlight"><pre><span class="sd">&quot;&quot;&quot;Greeter.</span>

<span class="sd">Usage:</span>
<span class="sd">  basic.py hello &lt;name&gt;</span>
<span class="sd">  basic.py goodbye &lt;name&gt;</span>
<span class="sd">  basic.py (-h | --help)</span>

<span class="sd">Options:</span>
<span class="sd">  -h --help     Show this screen.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>


<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Hello, {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">goodbye</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Goodbye, {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">arguments</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">arguments</span><span class="p">[</span><span class="s">&#39;hello&#39;</span><span class="p">]:</span>  <span class="c"># if an argument called hello was passed, execute the hello logic.</span>
        <span class="n">hello</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="s">&#39;&lt;name&gt;&#39;</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">arguments</span><span class="p">[</span><span class="s">&#39;goodbye&#39;</span><span class="p">]:</span>
        <span class="n">goodbye</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="s">&#39;&lt;name&gt;&#39;</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span class="nv">$ </span>python docopt/arguments.py hello Kyle
Hello, Kyle

<span class="nv">$ </span>python docopt/arguments.py hello --help
Greeter.

Usage:
  basic.py hello &lt;name&gt;
  basic.py goodbye &lt;name&gt;
  basic.py <span class="o">(</span>-h <span class="p">|</span> --help<span class="o">)</span>

Options:
  -h --help     Show this screen.
</pre></div>


<p>Note that the help message is not specific to the subcommand, rather it is the entire docstring for the program.</p>
<h3>Click</h3>
<p>In order to add an argument to a click command we simply use the <code>@click.argument</code> decorator. In this case we are just passing the argument name, but there are <a href="http://click.pocoo.org/4/arguments/">many more options</a> some of which we'll use later. With click command/subcommand dispatching is native. Since we are just decorating the logic (function) with the argument we dont need to do anything to set/dispatch to the correct logic.</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">click</span>


<span class="nd">@click.group</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">greet</span><span class="p">():</span>
    <span class="k">pass</span>


<span class="nd">@greet.command</span><span class="p">()</span>
<span class="nd">@click.argument</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>  <span class="c"># add the name argument</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Hello, {0}!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]))</span>


<span class="nd">@greet.command</span><span class="p">()</span>
<span class="nd">@click.argument</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">goodbye</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Goodbye, {0}!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]))</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">greet</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span class="nv">$ </span>python click/arguments.py hello Kyle
Hello, Kyle!

<span class="nv">$ </span>python click/arguments.py hello --help
Usage: arguments.py hello <span class="o">[</span>OPTIONS<span class="o">]</span> NAME

Options:
  --help  Show this message and exit.
</pre></div>


<h1>Flags/Options</h1>
<p>In this section I will again be adding new logic to the same code shown in the previous section. I'll add comments to new lines stating there purpose. Options are non-required inputs that can be given to alter the execution of a command-line tool. Flags are a subset of options that are True/False. For example: <code>--foo=bar</code> will pass <em>bar</em> as the value for the <em>foo</em> option, <code>--baz</code> (if defined as a flag) will pass the value of True is the option is given, or False if not.</p>
<p>For this example we are going to add the <code>--greeting=[greeting]</code> option, and the <code>--caps</code> flag. The <em>greeting</em> option will have default values of "Hello" and "Goodbye" (for hello, and goodbye commands) and allow the user to pass in a custom greeting. For example given <code>--greeting=Wazzup</code> the tool will respond with <em>Wazzup, [name]!</em>. The <code>--caps</code> flag will uppercase the entire response if given. For example given <code>--caps</code> the tool will respond with <em>HELLO, [NAME]!</em>.</p>
<h3>Argparse</h3>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">argparse</span>

<span class="c"># since we are now passing in the greeting the logic has been consolidated to a single greet function</span>
<span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s">&#39;{0}, {1}!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">greeting</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">caps</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">subparsers</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_subparsers</span><span class="p">()</span>

<span class="n">hello_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s">&#39;hello&#39;</span><span class="p">)</span>
<span class="n">hello_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>
<span class="n">hello_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&#39;--greeting&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;Hello&#39;</span><span class="p">)</span>  <span class="c"># add greeting option w/ default</span>
<span class="n">hello_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&#39;--caps&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&#39;store_true&#39;</span><span class="p">)</span>  <span class="c"># add a flag (default=False)</span>
<span class="n">hello_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">greet</span><span class="p">)</span>

<span class="n">goodbye_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s">&#39;goodbye&#39;</span><span class="p">)</span>
<span class="n">goodbye_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>
<span class="n">goodbye_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&#39;--greeting&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;Goodbye&#39;</span><span class="p">)</span>
<span class="n">goodbye_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&#39;--caps&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&#39;store_true&#39;</span><span class="p">)</span>
<span class="n">goodbye_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">greet</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">args</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span class="nv">$ </span>python argparse/options.py hello --greeting<span class="o">=</span>Wazzup Kyle
Wazzup, Kyle!

<span class="nv">$ </span>python argparse/options.py hello --caps Kyle
HELLO, KYLE!

<span class="nv">$ </span>python argparse/options.py hello --greeting<span class="o">=</span>Wazzup --caps Kyle
WAZZUP, KYLE!

<span class="nv">$ </span>python argparse/options.py hello --help
usage: options.py hello <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>--greeting GREETING<span class="o">]</span> <span class="o">[</span>--caps<span class="o">]</span> name

positional arguments:
  name

optional arguments:
  -h, --help           show this <span class="nb">help </span>message and <span class="nb">exit</span>
  --greeting GREETING
  --caps
</pre></div>


<h3>Docopt</h3>
<p>Once we hit the case of adding options with defaults we hit a snag with the basic implementation of commands in docopt. Let's continue just to illustrate the issue.</p>
<div class="highlight"><pre><span class="sd">&quot;&quot;&quot;Greeter.</span>

<span class="sd">Usage:</span>
<span class="sd">  basic.py hello &lt;name&gt; [--caps] [--greeting=&lt;str&gt;]</span>
<span class="sd">  basic.py goodbye &lt;name&gt; [--caps] [--greeting=&lt;str&gt;]</span>
<span class="sd">  basic.py (-h | --help)</span>

<span class="sd">Options:</span>
<span class="sd">  -h --help         Show this screen.</span>
<span class="sd">  --caps            Uppercase the output.</span>
<span class="sd">  --greeting=&lt;str&gt;  Greeting to use [default: Hello].</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>


<span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s">&#39;{0}, {1}!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="s">&#39;--greeting&#39;</span><span class="p">],</span>
                                <span class="n">args</span><span class="p">[</span><span class="s">&#39;&lt;name&gt;&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s">&#39;--caps&#39;</span><span class="p">]:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">arguments</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>
    <span class="n">greet</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span>
</pre></div>


<p>Now, see what happens when we run the following commands:</p>
<div class="highlight"><pre><span class="nv">$ </span>python docopt/options.py hello Kyle
Hello, Kyle!

<span class="nv">$ </span>python docopt/options.py goodbye Kyle
Hello, Kyle!
</pre></div>


<p>What?! Because we can only set a single default for the <code>--greeting</code> option both of our <em>Hello</em> and <em>Goodbye</em> commands now respond with <strong>Hello, Kyle!</strong>. In order for us to make this work we'll need to follow the <a href="https://github.com/docopt/docopt/tree/master/examples/git">git example</a> docopt provides. The refactored code is shown below:</p>
<div class="highlight"><pre><span class="sd">&quot;&quot;&quot;usage: greet [--help] &lt;command&gt; [&lt;args&gt;...]</span>

<span class="sd">options:</span>
<span class="sd">  -h --help         Show this screen.</span>

<span class="sd">commands:</span>
<span class="sd">   hello       Say hello</span>
<span class="sd">   goodbye     Say goodbye</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>

<span class="n">HELLO</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;usage: basic.py hello [options] [--] [&lt;name&gt;]</span>

<span class="s">  -h --help         Show this screen.</span>
<span class="s">  --caps            Uppercase the output.</span>
<span class="s">  --greeting=&lt;str&gt;  Greeting to use [default: Hello].</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">GOODBYE</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;usage: basic.py goodbye [options] [--] [&lt;name&gt;]</span>

<span class="s">  -h --help         Show this screen.</span>
<span class="s">  --caps            Uppercase the output.</span>
<span class="s">  --greeting=&lt;str&gt;  Greeting to use [default: Goodbye].</span>
<span class="s">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s">&#39;{0}, {1}!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="s">&#39;--greeting&#39;</span><span class="p">],</span>
                                <span class="n">args</span><span class="p">[</span><span class="s">&#39;&lt;name&gt;&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s">&#39;--caps&#39;</span><span class="p">]:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">arguments</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">__doc__</span><span class="p">,</span> <span class="n">options_first</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">arguments</span><span class="p">[</span><span class="s">&#39;&lt;command&gt;&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;hello&#39;</span><span class="p">:</span>
        <span class="n">greet</span><span class="p">(</span><span class="n">docopt</span><span class="p">(</span><span class="n">HELLO</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">arguments</span><span class="p">[</span><span class="s">&#39;&lt;command&gt;&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;goodbye&#39;</span><span class="p">:</span>
        <span class="n">greet</span><span class="p">(</span><span class="n">docopt</span><span class="p">(</span><span class="n">GOODBYE</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">exit</span><span class="p">(</span><span class="s">&quot;{0} is not a command. See &#39;options.py --help&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="s">&#39;&lt;command&gt;&#39;</span><span class="p">]))</span>
</pre></div>


<p>As you can see the <em>hello|goodbye</em> subcommands are now there own docstrings ties to variables <em>HELLO</em> and <em>GOODBYE</em>. When the tool is executed it uses a new argument <em>command</em> to decide which to parse. Not only does this correct the problem we had with only one default, but we now have subcommand specific help messages as well.</p>
<div class="highlight"><pre><span class="nv">$ </span>python docopt/options.py --help
usage: greet <span class="o">[</span>--help<span class="o">]</span> &lt;<span class="nb">command</span>&gt; <span class="o">[</span>&lt;args&gt;...<span class="o">]</span>

options:
  -h --help         Show this screen.

commands:
   hello       Say hello
   goodbye     Say goodbye

<span class="nv">$ </span>python docopt/options.py hello --help
usage: basic.py hello <span class="o">[</span>options<span class="o">]</span> <span class="o">[</span>--<span class="o">]</span> <span class="o">[</span>&lt;name&gt;<span class="o">]</span>

  -h --help         Show this screen.
  --caps            Uppercase the output.
  --greeting<span class="o">=</span>&lt;str&gt;  Greeting to use <span class="o">[</span>default: Hello<span class="o">]</span>.

<span class="nv">$ </span>python docopt/options.py hello Kyle
Hello, Kyle!

<span class="nv">$ </span>python docopt/options.py goodbye Kyle
Goodbye, Kyle!
</pre></div>


<p>In addition all of our new options/flags are working:</p>
<div class="highlight"><pre><span class="nv">$ </span>python docopt/options.py hello --greeting<span class="o">=</span>Wazzup Kyle
Wazzup, Kyle!

<span class="nv">$ </span>python docopt/options.py hello --caps Kyle
HELLO, KYLE!

<span class="nv">$ </span>python docopt/options.py hello --greeting<span class="o">=</span>Wazzup --caps Kyle
WAZZUP, KYLE!
</pre></div>


<h3>Click</h3>
<p>Adding the <em>greeting</em> and <em>caps</em> option to click is very simple, as we just use the <code>@click.option</code> decorator for both. Again, since we have default greetings now we have refactored the logic out into a single function.</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">click</span>


<span class="k">def</span> <span class="nf">greeter</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s">&#39;{0}, {1}!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;greeting&#39;</span><span class="p">],</span>
                                <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;caps&#39;</span><span class="p">]:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>


<span class="nd">@click.group</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">greet</span><span class="p">():</span>
    <span class="k">pass</span>


<span class="nd">@greet.command</span><span class="p">()</span>
<span class="nd">@click.argument</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>
<span class="nd">@click.option</span><span class="p">(</span><span class="s">&#39;--greeting&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;Hello&#39;</span><span class="p">)</span>  <span class="c"># add an option with &#39;Hello&#39; as the default</span>
<span class="nd">@click.option</span><span class="p">(</span><span class="s">&#39;--caps&#39;</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># add a flag (is_flag=True)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">greeter</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c"># the application logic has been refactored into a single function</span>


<span class="nd">@greet.command</span><span class="p">()</span>
<span class="nd">@click.argument</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>
<span class="nd">@click.option</span><span class="p">(</span><span class="s">&#39;--greeting&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;Goodbye&#39;</span><span class="p">)</span>
<span class="nd">@click.option</span><span class="p">(</span><span class="s">&#39;--caps&#39;</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">goodbye</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">greeter</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">greet</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span class="nv">$ </span>python click/options.py hello --greeting<span class="o">=</span>Wazzup Kyle
Wazzup, Kyle!

<span class="nv">$ </span>python click/options.py hello --greeting<span class="o">=</span>Wazzup --caps Kyle
WAZZUP, KYLE!

<span class="nv">$ </span>python click/options.py hello --caps Kyle
HELLO, KYLE!
</pre></div>


<h1>Version Option (-v/--version)</h1>
<p>In this section I'll be showing how to add a <code>--version</code> argument to each of our tools. For simplicity we'll just hardcode the version number to <em>1.0.0</em>. In a real production application you will want to pull this from the installed application. One way I have done this (there are many options) is with this simple process:</p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pkg_resources</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">(</span><span class="s">&quot;click&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">version</span>  <span class="c"># replace click with the name of your tool</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s">&#39;4.1&#39;</span>
</pre></div>


<h3>Argparse</h3>
<div class="highlight"><pre><span class="o">...</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&#39;--version&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&#39;version&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s">&#39;1.0.0&#39;</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>


<div class="highlight"><pre><span class="nv">$ </span>python argparse/version.py --version
1.0.0
</pre></div>


<h3>Docopt</h3>
<div class="highlight"><pre>
</pre></div>


<div class="highlight"><pre>
</pre></div>


<h3>Click</h3>
<div class="highlight"><pre>
</pre></div>


<div class="highlight"><pre>
</pre></div>


<h1>Improving Help (-h/--help)</h1>
<h3>Argparse</h3>
<div class="highlight"><pre>
</pre></div>


<div class="highlight"><pre>
</pre></div>


<h3>Docopt</h3>
<div class="highlight"><pre>
</pre></div>


<div class="highlight"><pre>
</pre></div>


<h3>Click</h3>
<div class="highlight"><pre>
</pre></div>


<div class="highlight"><pre>
</pre></div>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://twitter.com/PurdonKyle"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
                <li class="list-group-item"><a href="https://github.com/kpurdon"><i class="fa fa-github-square fa-lg"></i> Github</a></li>
                <li class="list-group-item"><a href="https://plus.google.com/u/0/+KylePurdon"><i class="fa fa-google-plus-square fa-lg"></i> Google+</a></li>
                <li class="list-group-item"><a href="http://www.reddit.com/user/kpurdon/"><i class="fa fa-reddit-square fa-lg"></i> Reddit</a></li>
                <li class="list-group-item"><a href="https://www.linkedin.com/in/kylepurdon"><i class="fa fa-linkedin-square fa-lg"></i> LinkedIn</a></li>
              </ul>
            </li>


            <li class="list-group-item"><a href="http://kylepurdon.com/blog/"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Categories</span></h4></a>
                <ul class="list-group" id="categories">
                    <li class="list-group-item">
                        <a href="http://kylepurdon.com/blog/category/demo.html">
                            <i class="fa fa-folder-open fa-lg"></i> Demo
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://kylepurdon.com/blog/category/discussion.html">
                            <i class="fa fa-folder-open fa-lg"></i> Discussion
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://kylepurdon.com/blog/category/software.html">
                            <i class="fa fa-folder-open fa-lg"></i> Software
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://kylepurdon.com/blog/category/software-tools.html">
                            <i class="fa fa-folder-open fa-lg"></i> Software, Tools
                        </a>
                    </li>
                </ul>
            </li>



    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 Kyle W. Purdon
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://kylepurdon.com/blog/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://kylepurdon.com/blog/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://kylepurdon.com/blog/theme/js/respond.min.js"></script>

    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-56650422-2']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

</body>
</html>